source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/Longitudinalplot_cleansample.R")
ggplot(organized_df, aes(x = t_DIT)) +
geom_line(aes(y=ID, group = ID ), size = .3) +
geom_point(aes(y=ID, color = as.factor(group),shape = factor(ses)), size=2) +
labs(x = "Duration of treatment (months)", y = "Subject ID", color = "Group", shape= "Session") +
theme(legend.position = "top", axis.text.y = element_text(size = 5)) +
geom_density(aes(y = -..density..*1000), fill= "#69b3a2") +
geom_label(aes(x=75, y=-10, label="density")) +
scale_x_continuous(breaks = c(specific_ticks, 0, 25, 50, 75, 100),
labels = c(specific_labels, 0, 25, 50, 75, 100)) +
geom_text(aes(x=12, y=-20, label="1y"), size=3) +
geom_text(aes(x=12*2, y=-20, label="2y"), size=3) +
geom_text(aes(x=12*4, y=-20, label="4y"), size=3) +
geom_text(aes(x=12*6, y=-20, label="6y"), size=3) +
geom_text(aes(x=12*7, y=-20, label="7y"), size=3)
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/Longitudinalplot_cleansample.R")
ggplot(organized_df, aes(x = t_DIT)) +
geom_line(aes(y=ID, group = ID ), size = .3) +
geom_point(aes(y=ID, color = as.factor(group),shape = factor(ses)), size=2) +
labs(x = "Duration of treatment (months)", y = "Subject ID", color = "Group", shape= "Session") +
theme(legend.position = "top", axis.text.y = element_text(size = 5)) +
geom_density(aes(y = -..density..*1000), fill= "#69b3a2") +
geom_label(aes(x=75, y=-10, label="density")) +
scale_x_continuous(breaks = c(specific_ticks, 0, 25, 50, 75, 100),
labels = c(specific_labels, 0, 25, 50, 75, 100)) +
geom_text(aes(x=12, y=-20, label="1y"), size=3) +
geom_text(aes(x=12*2, y=-20, label="2y"), size=3) +
geom_text(aes(x=12*4, y=-20, label="4y"), size=3) +
geom_text(aes(x=12*6, y=-20, label="6y"), size=3) +
geom_text(aes(x=12*7, y=-20, label="7y"), size=3)
## Plot ####
ggplot(organized_df, aes(x = t_DIT)) +
geom_line(aes(y=ID, group = ID ), size = .3) +
geom_point(aes(y=ID, color = as.factor(group),shape = factor(ses)), size=2) +
labs(x = "Duration of treatment (months)", y = "Subject ID", color = "Group", shape= "Session") +
theme(legend.position = "top", axis.text.y = element_text(size = 5)) +
geom_density(aes(y = -..density..*100), fill= "#69b3a2") +
geom_label(aes(x=75, y=-10, label="density")) +
scale_x_continuous(breaks = c(specific_ticks, 0, 25, 50, 75, 100),
labels = c(specific_labels, 0, 25, 50, 75, 100)) +
geom_text(aes(x=12, y=-20, label="1y"), size=3) +
geom_text(aes(x=12*2, y=-20, label="2y"), size=3) +
geom_text(aes(x=12*4, y=-20, label="4y"), size=3) +
geom_text(aes(x=12*6, y=-20, label="6y"), size=3) +
geom_text(aes(x=12*7, y=-20, label="7y"), size=3)
View(organized_df)
hist(df$age)?
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
scale_fill_manual(values = c("HC" = "blue", "nonTRS" = "green", "TRS" = "red")) +
theme_minimal() +
labs(x = "Value", y = "Frequency", title = "Histogram by Group")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30)
View(df)
# Set environment ####
rm(list= ls())# ctrl + L to clear console
#setwd("~/Documents/GitHub/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/")
setwd("/Users/brainsur/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT")
library(tidyverse)
# PREPARE DATA ####
## Import data ####
sample<-read.csv("subjects_May2024.csv")
sample$Excluir[sample$ID=="C104"]
sample$Excluir[sample$ID=="C104"] <- 1
sample$Excluir[sample$ID=="C105"] <- 1
write.csv(sample, 'subjects_May2024.csv')
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
labs(x = "Age", y = "Frequency", title = "Histogram by Group")
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/Longitudinalplot_cleansample.R")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
labs(x = "Age", y = "Frequency", title = "Histogram by Group")
ggplot(organized_df, aes(x = t_DIT)) +
geom_line(aes(y=ID, group = ID ), size = .3) +
geom_point(aes(y=ID, color = as.factor(group),shape = factor(ses)), size=2) +
labs(x = "Duration of treatment (months)", y = "Subject ID", color = "Group", shape= "Session") +
theme(legend.position = "top", axis.text.y = element_text(size = 5)) +
geom_density(aes(y = -..density..*500), fill= "#69b3a2") +
geom_label(aes(x=75, y=-10, label="density")) +
scale_x_continuous(breaks = c(specific_ticks, 0, 25, 50, 75, 100),
labels = c(specific_labels, 0, 25, 50, 75, 100)) +
geom_text(aes(x=12, y=-20, label="1y"), size=3) +
geom_text(aes(x=12*2, y=-20, label="2y"), size=3) +
geom_text(aes(x=12*4, y=-20, label="4y"), size=3) +
geom_text(aes(x=12*6, y=-20, label="6y"), size=3) +
geom_text(aes(x=12*7, y=-20, label="7y"), size=3)
df[df$ID=='C104'] <- NULL
View(df)
View(df)
class(df$ID)
df[df$ID=='C104']
df$age[df$ID=='C104']
df[[df$ID=='C104'],] <- NULL
df[df$ID=='C104',]
df[df$ID=='C104',] <- NULL
df <- df[df$ID != 'C104', ]
df <- df[df$ID != 'C105', ]
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/Longitudinalplot_cleansample.R")
HC_data <- filter(df, group == "HC")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
labs(x = "Age", y = "Frequency")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
theme_light() +
labs(x = "Age", y = "Frequency")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
theme_classic() +
labs(x = "Age", y = "Frequency")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
labs(x = "Age", y = "Frequency")
p <- df %>%
ggplot( aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
install.packages("hrbrthemes")
library(hrbrthemes)
p <- df %>%
ggplot( aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
ggplot(df, aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
ggplot(df, aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("#69b3a2", "#404080","red")) +
theme_ipsum() +
labs(fill="")
ggplot(organized_df, aes(x = t_DIT)) +
geom_line(aes(y=ID, group = ID ), size = .3) +
geom_point(aes(y=ID, color = as.factor(group),shape = factor(ses)), size=2) +
labs(x = "Duration of treatment (months)", y = "Subject ID", color = "Group", shape= "Session") +
theme(legend.position = "top", axis.text.y = element_text(size = 5)) +
geom_density(aes(y = -..density..*500), fill= "#69b3a2") +
geom_label(aes(x=75, y=-10, label="density")) +
scale_x_continuous(breaks = c(specific_ticks, 0, 25, 50, 75, 100),
labels = c(specific_labels, 0, 25, 50, 75, 100)) +
geom_text(aes(x=12, y=-20, label="1y"), size=3) +
geom_text(aes(x=12*2, y=-20, label="2y"), size=3) +
geom_text(aes(x=12*4, y=-20, label="4y"), size=3) +
geom_text(aes(x=12*6, y=-20, label="6y"), size=3) +
geom_text(aes(x=12*7, y=-20, label="7y"), size=3)
p <- df %>%
ggplot(df, aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red","#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/Longitudinalplot_cleansample.R")
p <- df %>%
ggplot( aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red","#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
p.show()
ggplot(df, aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red","#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/PrepareCSVdatabase.R")
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/PrepareCSVdatabase.R")
# Set environment ####
rm(list= ls())# ctrl + L to clear console
#setwd("~/Documents/GitHub/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/")
setwd("/Users/brainsur/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT")
library(tidyverse)
# PREPARE DATA ####
## Import data ####
sample<-read.csv("subjects_May2024.csv")
#keep only columns and rows of interest
df <- sample[, c("ID", "Grupo","Fecha_nacimiento","Sexo",
"MRI_1","MRI_2","MRI_3","MRI_4", "MRI_5",
"APdose_1","APdose_2","APdose_3","APdose_4","APdose_5",
"PANSS_TP_1","PANSS_TP_2","PANSS_TP_3","PANSS_TP_4","PANSS_TP_5",
"DUP.months.","DIT_preSess1.days.",
"DIT_sess1toLastsess","Duration_of_illness.months.",
"Excluir")]
rm(sample) #remove original full df
## Change data classes ####
### PATIENTS ####
#Correct class and format of dates (Birth and MRI dates)
df$Fecha_nacimiento <- as.Date(df$Fecha_nacimiento, format = "%d/%m/%Y")
df$MRI_1 <- as.Date(df$MRI_1, format = "%d/%m/%Y")
df$MRI_2 <- as.Date(df$MRI_2, format = "%d/%m/%Y")
df$MRI_3 <- as.Date(df$MRI_3, format = "%d/%m/%Y")
df$MRI_4 <- as.Date(df$MRI_4, format = "%d/%m/%Y")
df$MRI_5 <- as.Date(df$MRI_5, format = "%d/%m/%Y")
View(df)
df$ID <- as.factor(df$ID)
df$Grupo <- as.factor(df$Grupo)
df$Sexo <- as.factor(df$Sexo)
# Rename the levels in Group: Resistente = TRS ; No_resistente = nonTRS
levels(df$Grupo)
levels(df$Grupo) <- c("HC","nonTRS", "TRS")
df$DUP.months. <- gsub(",", ".", df$DUP.months.)
df$DIT_preSess1.days. <- gsub(",", ".", df$DIT_preSess1.days.)
df$DIT_sess1toLastsess <- gsub(",", ".", df$DIT_sess1toLastsess)
df$Duration_of_illness.months. <- gsub(",", ".", df$Duration_of_illness.months.)
df$APdose_1 <- gsub(",", ".", df$APdose_1)
df$APdose_2 <- gsub(",", ".", df$APdose_2)
df$APdose_3 <- gsub(",", ".", df$APdose_3)
df$APdose_4 <- gsub(",", ".", df$APdose_4)
df$APdose_5 <- gsub(",", ".", df$APdose_5)
df$PANSS_TP_1 <- gsub(",", ".", df$PANSS_TP_1)
df$PANSS_TP_2 <- gsub(",", ".", df$PANSS_TP_2)
df$PANSS_TP_3 <- gsub(",", ".", df$PANSS_TP_3)
df$PANSS_TP_4 <- gsub(",", ".", df$PANSS_TP_4)
df$PANSS_TP_5 <- gsub(",", ".", df$PANSS_TP_5)
# Then)
df$DUP.months. <- as.numeric(df$DUP.months.)
df$DIT_preSess1.days. <- as.numeric(df$DIT_preSess1.days.)
df$DIT_sess1toLastsess <- as.numeric(df$DIT_sess1toLastsess)
df$Duration_of_illness.months. <- as.numeric(df$Duration_of_illness.months.)
df$APdose_1 <- as.numeric(df$APdose_1)
df$APdose_2 <- as.numeric(df$APdose_2)
df$APdose_3 <- as.numeric(df$APdose_3)
df$APdose_4 <- as.numeric(df$APdose_4)
df$APdose_5 <- as.numeric(df$APdose_5)
df$PANSS_TP_1  <- as.numeric(df$PANSS_TP_1)
df$PANSS_TP_2  <- as.numeric(df$PANSS_TP_2)
df$PANSS_TP_3  <- as.numeric(df$PANSS_TP_3)
df$PANSS_TP_4  <- as.numeric(df$PANSS_TP_4)
df$PANSS_TP_5  <- as.numeric(df$PANSS_TP_5)
sapply(df, class)
df <- df[!df$Excluir==1,]
View(df)
df$ID[!is.na(df$Fecha_nacimiento), ]
df[!is.na(df$Fecha_nacimiento), ]
df$ID[!is.na(df$Fecha_nacimiento)]
df$ID[is.na(df$Fecha_nacimiento)]
df <- df[!is.na(df$Fecha_nacimiento), ] #excluded 0
df[is.na(df$Sexo)]
df <- df[!is.na(df$Fecha_nacimiento), ] #excluded 0
df <- df[!is.na(df$Sexo), ] #excluded 0
df[is.na(df$Grupo)]
View(df)
df[is.na(df$Grupo)]
df[is.na(df$Grupo),]
# t0 = ses 1
df$t1 <- 0
#time difference in "months" = weeks/4
df$t2<- df$t1 + as.numeric(difftime(df$MRI_2, df$MRI_1, units = 'weeks'))/4
df$t3<- df$t1 + as.numeric(difftime(df$MRI_3, df$MRI_1, units = 'weeks'))/4
df$t4<- df$t1 + as.numeric(difftime(df$MRI_4, df$MRI_1, units = 'weeks'))/4
df$t5<- df$t1 + as.numeric(difftime(df$MRI_5, df$MRI_1, units = 'weeks'))/4
# Export the data frame to a CSV file
long_data <- pivot_longer(df,
cols = starts_with("MRI") | starts_with("t") | starts_with("AP") | starts_with("PANSS"),
names_to = c(".value", "session"),
names_pattern = "(\\D+)(\\d+)")
long_data$PANSS_TP_[long_data$Grupo == "HC"] <- 0
long_data$APdose_[long_data$Grupo == "HC"] <- 0
long_data$Control[long_data$Grupo == "HC"] <- 1
long_data$Control[long_data$Grupo != "HC"] <- 0
long_data$Resistance[long_data$Grupo == "TRS"] <- 1
long_data$Resistance[long_data$Grupo != "TRS"] <- 0
View(df)
write.csv(long_data, file = "subjects_finallist_DIT.csv", row.names = FALSE)
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/PrepareCSVdatabase.R")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
labs(x = "Age", y = "Frequency")
ggplot(organized_df, aes(x = t_DIT)) +
geom_line(aes(y=ID, group = ID ), size = .3) +
geom_point(aes(y=ID, color = as.factor(group),shape = factor(ses)), size=2) +
labs(x = "Duration of treatment (months)", y = "Subject ID", color = "Group", shape= "Session") +
theme(legend.position = "top", axis.text.y = element_text(size = 5)) +
geom_density(aes(y = -..density..*500), fill= "#69b3a2") +
geom_label(aes(x=75, y=-10, label="density")) +
scale_x_continuous(breaks = c(specific_ticks, 0, 25, 50, 75, 100),
labels = c(specific_labels, 0, 25, 50, 75, 100)) +
geom_text(aes(x=12, y=-20, label="1y"), size=3) +
geom_text(aes(x=12*2, y=-20, label="2y"), size=3) +
geom_text(aes(x=12*4, y=-20, label="4y"), size=3) +
geom_text(aes(x=12*6, y=-20, label="6y"), size=3) +
geom_text(aes(x=12*7, y=-20, label="7y"), size=3)
source("~/Desktop/GitHub_repos/Striatocortical-connectivity-FEPtrt/LongitudinalPLOT/Longitudinalplot_cleansample.R")
ggplot(organized_df, aes(x = t_DIT)) +
geom_line(aes(y=ID, group = ID ), size = .3) +
geom_point(aes(y=ID, color = as.factor(group),shape = factor(ses)), size=2) +
labs(x = "Duration of treatment (months)", y = "Subject ID", color = "Group", shape= "Session") +
theme(legend.position = "top", axis.text.y = element_text(size = 5)) +
geom_density(aes(y = -..density..*500), fill= "#69b3a2") +
geom_label(aes(x=75, y=-10, label="density")) +
scale_x_continuous(breaks = c(specific_ticks, 0, 25, 50, 75, 100),
labels = c(specific_labels, 0, 25, 50, 75, 100)) +
geom_text(aes(x=12, y=-20, label="1y"), size=3) +
geom_text(aes(x=12*2, y=-20, label="2y"), size=3) +
geom_text(aes(x=12*4, y=-20, label="4y"), size=3) +
geom_text(aes(x=12*6, y=-20, label="6y"), size=3) +
geom_text(aes(x=12*7, y=-20, label="7y"), size=3)
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
labs(x = "Age", y = "Frequency")
ggplot(df, aes(x=age, fill=group)) +
geom_histogram( color="#e9ecef", alpha=0.6, position = 'identity') +
scale_fill_manual(values=c("red","#69b3a2", "#404080")) +
theme_ipsum() +
labs(fill="")
ggplot(df, aes(x = age, fill = group)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
labs(x = "Age", y = "Frequency")
